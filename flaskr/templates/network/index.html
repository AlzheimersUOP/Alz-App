<html>

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>GeNet | Clustering</title>

    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.png') }}">
    <!-- Materializecss compiled and minified CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/materialize.min.css') }}">

    <!--bootstrap-->
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">

    <!--Import Google Icon Font-->
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/fonts/family=Material+Icons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/materialize-stepper.css') }}">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/materialize.min.css') }}">

    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>

    <style>

        #mynetwork {
            width: 100%;
            height: 600px;
        }

        div.centre {
            display: block;
            margin-left: auto;
            margin-right: auto;
            margin-top: 0;
            margin-bottom: 0;
            align-content: center;
            text-align: center;
        }

        ul {
            list-style-type: circle;
        }

        .modal {
            bottom: inherit;
        }

        .modal-content {
            position: initial;
            background-color: inherit;
            border-radius: inherit;
            border: inherit;
        }

        #result_view {
            display: none;
        }
    </style>

</head>

<body class="main-body" style="background-color: #f3f6f9;font-family: monospace;">

<!-- Dropdown Structure -->
{% include 'horizontal_nav_bar.html' %}

<div class="main-div-config">

    <div id="mainDataInterface-id" class="container mainDataInterface">

        <div class="step-content">
            {% if node %}

                <div class="row">
                    <h3 id="h3-head-6" class="card__title"
                        style="text-align: center;color: #26a69a;font-family: monospace;">CLUSTERING</h3>
                </div>
                <div class="row">
                    <div class="col-sm-1"></div>
                    <div class="col-sm-6">
                        <label style="float: right;font-size: 20px;"><b>Selected File: </b> {{ filename }}</label>
                    </div>
                    <div class="col-sm-3 change_file_div">
                        <a onclick="open_modal()" href="#"
                           style="color: #26a69a;text-decoration: none;font-size: 15px;"><i
                                class="fas fa-exchange-alt fa-2x"></i> Change file</a>
                    </div>
                    <div class="col-sm-2"></div>
                </div>

                <div class="row">
                    <div class="result_content">
                        <div id="mynetwork"></div>
                    </div>
                </div>

            {% endif %}

            <!-- Modal Structure -->
            <div id="modal1" class="modal">
                <div class="modal-content">
                    <div class="row">
                        <h4 id="h3-head-1" class="card__title"
                            style="text-align: center;font-family: monospace;">Choose File</h4>

                    </div>
                    {% if all_names | length == 0 %}
                        <div class="alert alert-danger">
                            <strong>Danger!</strong> You don't have done feature selection. <a
                                href="{{ url_for('fs.index') }}">Lets start</a>
                        </div>
                    {% endif %}

                    <div class="content">
                        <form method="post" action="/net/" enctype="multipart/form-data" id="main-form">

                            <div class="md-form">
                                <select style="font-family: monospace;" class="form-control" id="file_name"
                                        name="file_name">
                                    <option disabled="disabled" selected>Pick a choice!</option>
                                    {% for name in all_names %}
                                        <option value="{{ name }}">{{ name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="modal-close waves-effect waves-green btn-flat" id="submit_button">Submit</button>
                    {% if node %}
                        <a class="modal-close waves-effect waves-green btn-flat" href="#">Close</a>
                    {% else %}
                        <a class="modal-close waves-effect waves-green btn-flat" href="../">Close</a>
                    {% endif %}
                </div>
            </div>


        </div>

    </div>
</div>

<div class="loader-div" style="display: none;">
    <div id="loader" class="center-load"></div>
    <h5 style="text-align: center;color: #26a69a;">PROCESSING</h5>
</div>

{% include 'footer.html' %}

</body>
</html>

<script type="text/javascript" src="{{ url_for('static', filename='js/jquery/jquery.min.js') }}"></script>

<script type="text/javascript" src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js'></script>

<!-- Materializecss compiled and minified JavaScript -->
<script type="text/javascript" src="{{ url_for('static', filename='js/materialize.min.js') }}"></script>

<!-- jQueryValidation Plugin -->
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery/jquery.validate.min.js') }}"></script>

<!-- Compiled and minified JavaScript -->
<script type="text/javascript" src="{{ url_for('static', filename='js/materialize/materialize.min.js') }}"></script>

{% if g.user['is_verified'] == 2 %}
    <script type="text/javascript" src="{{ url_for('static', filename='js/google_auth_main.js') }}"></script>

    <script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>
{% else %}
    <script type="text/javascript" src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endif %}

<script type="text/javascript" src="{{ url_for('static', filename='js/fontawesome-all.js') }}"></script>

{% if node %}

    <script type="text/javascript">
        function draw() {
            // create some nodes
            var nodes = {{ node | tojson }};

            // create some edges
            var edges = {{ edges | tojson }};

            // create a network
            var container = document.getElementById("mynetwork");
            var data = {
                nodes: nodes,
                edges: edges
            };
            var options = {
                nodes: {
                    shape: "dot",
                    size: 16
                },
                physics: {
                    forceAtlas2Based: {
                        gravitationalConstant: -26,
                        centralGravity: 0.005,
                        springLength: 230,
                        springConstant: 0.18
                    },
                    maxVelocity: 146,
                    solver: "forceAtlas2Based",
                    timestep: 0.35,
                    stabilization: {iterations: 150}
                }
            };
            var network = new vis.Network(container, data, options);
        }

        function open_modal() {
            $('#modal1').openModal();
        }

        draw();

    </script>

{% else %}

    <script>

        $('#modal1').openModal({dismissible: false});

    </script>

{% endif %}

<script>
    $('#submit_button').click(function () {
        $('.main-div-config').hide(0);
        $('.loader-div').show(0);
        $('.main-body').click(false);
        $("#main-form").submit();
    });
</script>