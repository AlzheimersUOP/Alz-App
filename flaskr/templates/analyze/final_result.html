<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>GeNet | {{ method }} | RESULTS</title>

    <!--bootstrap-->
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.png') }}">

    <!--Import Google Icon Font-->
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/fonts/family=Material+Icons.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/materialize-stepper.css') }}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/materialize.min.css') }}">

    <style>
        .summary_plot > img {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
            width: 100%;
        }

        .result_content {
            border-color: #26a69a;
            border-style: ridge;
            padding: 15px;
            margin-top: 10px;
            margin-bottom: 10px;
        {#            border: 1px solid #ccc !important;#} border-radius: 16px;
        }

    </style>

</head>

<style>
    #loader {
        border: 12px solid #26a69a66;
        border-radius: 50%;
        border-top: 12px solid #26a69a;
        width: 70px;
        height: 70px;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        100% {
            transform: rotate(360deg);
        }
    }

    .center-load {
        position: absolute;
        top: -230px;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
    }

    .container-1 {
        position: relative;
        text-align: center;
    }

    .top-right {
        position: absolute;
        top: 8px;
        right: 5px;
    }

</style>

<style type="text/css">

    @keyframes grow {
        from {
            opacity: 0;
            transform: scale(0.5);
        }
        to {
            opacity: 1;
            transform: scale(1);
        }
    }

    .notification.hide {
        animation: shrink 0.4s ease-out forwards;
    }

    @keyframes shrink {
        to {
            opacity: 0;
            transform: scale(0.6);
        }
    }

    .notification-info {
        background-color: #00000096;
    }

</style>

<body class="main-body" style="background-color: #f3f6f9;font-family: monospace;">

<!-- Dropdown Structure -->
{% include 'horizontal_nav_bar.html' %}

<div class="main-div-an-3">
    <div class="card-content">

        <ul data-method="GET" class="stepper linear">
            <li class="step">
                <a href="{{ url_for('preprocess.index') }}">
                    <div class="step-title waves-effect waves-dark">Pre-processing</div>
                </a>
            </li>
            <li class="step">
                <a href="{{ url_for('fs.index') }}">
                    <div class="step-title waves-effect waves-dark">Feature selection</div>
                </a>
            </li>
            <li class="step active">
                <a href="{{ url_for('analyze.index') }}">
                    <div class="step-title waves-effect waves-dark">Analysis</div>
                </a>
            </li>
            <li class="step">
                <a href="{{ url_for('validation.index') }}">
                    <div class="step-title waves-effect waves-dark">Validation</div>
                </a>
            </li>
        </ul>

    </div>

    <div id="mainDataInterface-id" class="container mainDataInterface">

        <div class="step">
            <div class="step-content">
                <div class="row">
                    <label style="float: left"><b>Selected File: </b> {{ filename }}</label>
                    <a href="../fs/an/config" style="float: right"><i class="fas fa-exchange-alt fa-2x"></i> Change file</a>
                </div>

                <div class="result_content">
                    <div class="row">
                        <h3 id="h3-head-6" class="card__title"
                            style="text-align: center;color: #26a69a;font-family: monospace;text-transform: uppercase;">
                            {{ method }} Selected Features </h3>
                        <h3 id="selected-method" style="display: none;">{{ method }}</h3>
                    </div>

                    <div id="gene_output_div1" class="alert alert-info">
                        <strong>Info!</strong> {{ method }} extracted {{ len[0] }} features. <h6>{{ col[0] }}</h6>
                    </div>

                    <div class="row">
                        <div id="results_plot_div1" class="container-1">
                            <div class="summary_plot">
                                <img id="selected_features" src="data:image/png;base64,{{ sel_roc }}" alt="overlap">
                            </div>
                            <div class="top-right">
                                <button type="button"
                                        style="margin-left: 10px;color: #26a69a;border: none; background-color: white;"
                                        class="use-download-selected_features" value="">
                                    <i class="fas fa-file-download fa-2x"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="row">

                            <h3 id="h3-head-2" class="card__title" style="text-align: center;"></h3>
                        </div>

                        <div class="row">
                            <p class="card__title" style="font-size: 15px;text-align: justify; font-family: monospace;">
                                A ROC curve is constructed by plotting the true positive rate (TPR) against the false
                                positive rate (FPR). The true positive rate is the proportion of observations that were
                                correctly predicted to be positive out of all positive observations (TP/(TP + FN)).
                                Similarly, the false positive rate is the proportion of observations that are
                                incorrectly predicted to be positive out of all negative observations (FP/(TN + FP)).
                                This graph shows the ROC curve consideing the genes obtained through considering least
                                correlation !</p>
                            <p class="card__title" style="font-size: 15px;text-align: justify; font-family: monospace;">
                                The correlation matrix of the genes selected by {{ method }} only !</p>
                        </div>

                        <br>

                        <div id="results_table_div1" style="overflow: auto;">
                            {% for table in table_r1 %}
                                {{ table|safe }}
                            {% endfor %}

                        </div>
                    </div>
                </div>

                <div class="result_content">
                    <div class="row">
                        <h3 id="h3-head-6" class="card__title"
                            style="text-align: center;color: #26a69a;text-transform: uppercase;">{{ method }} +
                            Overlapped
                            Features</h3>
                    </div>

                    <div id="gene_output_div2" class="alert alert-info">
                        <strong>Info!</strong> {{ method }} + overlapped extracted {{ len[1] }} features.
                        <h6>{{ col[1] }}</h6>
                    </div>

                    <div class="row">
                        <div id="results_plot_div2" class="container-1">
                            <div class="summary_plot">
                                <img id="overlapped_features" src="data:image/png;base64,{{ all_roc }}" alt="overlap">
                            </div>
                            <div class="top-right">
                                <button type="button"
                                        style="margin-left: 10px;color: #26a69a;border: none; background-color: white;"
                                        class="use-download-overlapped_features" value="">
                                    <i class="fas fa-file-download fa-2x"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="row">

                            <h3 id="h3-head-2" class="card__title" style="text-align: center;"></h3>
                        </div>

                        <div class="row">
                            <p class="card__title" style="font-size: 15px;text-align: justify; font-family: monospace;">
                                The graph(left) shows the ROC curve of all the genes selected.That is, the set of
                                overlapped genes plus the genes filtered out by {{ method }} considering the least
                                correlation, The graph(right) shows the correlation matrix of all the genes selected.
                                That is, the set of overlapped genes plus the genes filtered out by considering the
                                least correlation !</p>
                        </div>

                        <br>

                        <div id="results_table_div2" style="overflow: auto;">
                            {% for table in table_r2 %}
                                {{ table|safe }}
                            {% endfor %}

                        </div>
                    </div>
                </div>

                <hr class="line-hr">

                <div class="step-actions">
                    <button id="btn-submit-an-3-continue" class="waves-effect waves-dark btn next-step step-6-click">
                        <a>VALIDATION</a>
                    </button>
                    <button class="waves-effect waves-dark btn-flat previous-step">
                        <a href="{{ url_for('analyze.selected_method') }}">BACK</a>
                    </button>
                </div>
            </div>
        </div>

        <form id="main-form-div-an-3-continue" style="display: none" action="/val" method="get" id="form">
            <input type="hidden" id="id" name="id" value="{{ result_id }}"/>
        </form>

    </div>
</div>

<div class="loader-div" style="display: none;">
    <div id="loader" class="center-load"></div>
    <h5 style="margin-top: 18%;text-align: center;color: #26a69a; margin-bottom: 200px;">VALIDATING</h5>
</div>

{% include 'guide_footer.html' %}

</body>
</html>

<script type="text/javascript" src="{{ url_for('static', filename='js/jquery/jquery.min.js') }}"></script>

<script type="text/javascript" src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js'></script>

<!-- Materializecss compiled and minified JavaScript -->
<script type="text/javascript" src="{{ url_for('static', filename='js/materialize.min.js') }}"></script>

<!-- jQueryValidation Plugin -->
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery/jquery.validate.min.js') }}"></script>

<!-- Compiled and minified JavaScript -->
<script type="text/javascript" src="{{ url_for('static', filename='js/materialize/materialize.min.js') }}"></script>

<script type="text/javascript" src="{{ url_for('static', filename='js/main.js') }}"></script>

<script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script>

<script type="text/javascript" src="{{ url_for('static', filename='js/fontawesome-all.js') }}"></script>

<script>
    $('#btn-submit-an-3-continue').click(function () {
        $('.main-div-an-3').hide(0);
        $('.loader-div').show(0);
        $('.main-body').click(false);

        var fired_button = $(this).val();

        $("#selected_method").val(fired_button);

        $("#main-form-div-an-3-continue").submit();

        $('#tourControls').hide(0);
        $('.notification-container-pop').hide(0);

    });

    selected_method = $('#selected-method').text();

    $(".use-download-selected_features").click(function () {
        var img = document.getElementById('selected_features');
        var url = img.src;

        var a1 = document.createElement("a");
        a1.href = url;
        a1.download = selected_method + "_" + "selected_features.png";
        a1.click();

        $('#tourControls').hide(0);
    });

    $(".use-download-overlapped_features").click(function () {
        var img = document.getElementById('overlapped_features');
        var url = img.src;

        var a2 = document.createElement("a");
        a2.href = url;
        a2.download = selected_method + "_" + "overlapped_features.png";
        a2.click();

        $('#tourControls').hide(0);
    });
</script>

<script type="text/javascript" src="{{ url_for('static', filename='js/guide/jquery.aSimpleTour.js') }}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.js"></script>

<script type="text/javascript" src="{{ url_for('static', filename='js/guide/guide_data.js') }}"></script>

<script type="text/javascript" src="{{ url_for('static', filename='js/guide/guide_main.js') }}"></script>

<script>

    var tour = guide_main_call(tip_an_final, 'BL');

</script>